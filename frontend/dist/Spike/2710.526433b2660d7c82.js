"use strict";(self.webpackChunkSpike=self.webpackChunkSpike||[]).push([[2710],{2710:(Zt,R,c)=>{c.r(R),c.d(R,{REPORTES_ROUTES:()=>Wt});var p=c(177),D=c(9183),t=c(3953),N=c(8887),T=c(5312),$=c(1626);let w=(()=>{class e{constructor(o){this.http=o}generarReporteExcel(o){return this.http.get(`${T.c.apiUrl}/activo-fijo-local/excel`,{params:{companyId:o??""},responseType:"blob"})}static#t=this.\u0275fac=function(a){return new(a||e)(t.KVO($.Qq))};static#e=this.\u0275prov=t.jDH({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})();var v=c(7291);let G=(()=>{class e{constructor(o,a,i){this.router=o,this.reportesService=a,this.storage=i}ngOnInit(){this.storageSubscription=this.storage.user$.subscribe(o=>{o&&(this.user=o)}),this.generarReporte()}generarReporte(){const o=this.user.selectedCompany.id,a=this.user.selectedCompany.nombre.toLowerCase().includes("gruman");this.reportesService.generarReporteExcel(a?null:o).subscribe(i=>{const r=window.URL.createObjectURL(i),m=document.createElement("a");m.href=r,m.download="reporte_activos.xlsx",document.body.appendChild(m),m.click(),window.URL.revokeObjectURL(r),document.body.removeChild(m)},i=>{console.error("Error al generar el reporte:",i)}).add(()=>{this.router.navigate(["/mantenedores/activo-fijo-local"])})}static#t=this.\u0275fac=function(a){return new(a||e)(t.rXU(N.Ix),t.rXU(w),t.rXU(v.n))};static#e=this.\u0275cmp=t.VBU({type:e,selectors:[["app-activos"]],standalone:!0,features:[t.aNF],decls:5,vars:0,consts:[[1,"container"],[1,"wrap-spinner"],[1,"mt-4"]],template:function(a,i){1&a&&(t.j41(0,"div",0)(1,"div",1),t.nrm(2,"mat-spinner"),t.j41(3,"h2",2),t.EFF(4,"Generando reporte..."),t.k0s()()())},dependencies:[p.MD,D.D6,D.LG],styles:[".wrap-spinner[_ngcontent-%COMP%]{background-color:#fff;width:100%;height:100%;display:flex;justify-content:center;align-items:center;border-radius:15px;padding:20px;gap:20px}"]})}return e})();var h=c(5596),s=c(9159),f=c(3719),g=c(9631),b=c(5084),E=c(9213),F=c(6600),C=c(8834),Y=c(7673),y=c(9172),x=c(6354),_=c(850),I=c(6695),l=c(9417),S=c(4823);let O=(()=>{class e{constructor(o){this.http=o}getInformeConsumo(o,a,i){return this.http.get(`${T.c.apiUrl}/informe-consumo`,{params:{fechaInicio:o||null,fechaFin:a||null,clienteId:i||null}})}static#t=this.\u0275fac=function(a){return new(a||e)(t.KVO($.Qq))};static#e=this.\u0275prov=t.jDH({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})();const q=()=>[5,10,25,100];function L(e,n){if(1&e){const o=t.RV6();t.j41(0,"button",39),t.bIt("click",function(){t.eBV(o);const i=t.XpG();return t.Njj(i.clearClient())}),t.j41(1,"mat-icon"),t.EFF(2,"close"),t.k0s()()}}function M(e,n){if(1&e&&(t.j41(0,"mat-option",9),t.EFF(1),t.k0s()),2&e){const o=n.$implicit;t.Y8G("value",o),t.R7$(),t.SpI(" ",o," ")}}function U(e,n){1&e&&(t.j41(0,"mat-error"),t.EFF(1," El cliente es requerido "),t.k0s())}function P(e,n){1&e&&(t.j41(0,"mat-error"),t.EFF(1," La fecha de inicio es requerida "),t.k0s())}function A(e,n){1&e&&(t.j41(0,"mat-error"),t.EFF(1," La fecha de fin es requerida "),t.k0s())}function B(e,n){1&e&&(t.j41(0,"th",40),t.EFF(1," Requerimiento "),t.k0s())}function X(e,n){if(1&e&&(t.j41(0,"td",41),t.EFF(1),t.k0s()),2&e){const o=n.$implicit;t.Y8G("matTooltip",o.requerimiento),t.R7$(),t.SpI(" ",o.requerimiento," ")}}function H(e,n){1&e&&(t.j41(0,"th",40),t.EFF(1," Servicio "),t.k0s())}function J(e,n){if(1&e&&(t.j41(0,"td",41),t.EFF(1),t.k0s()),2&e){const o=n.$implicit;t.Y8G("matTooltip",o.tipo_servicio),t.R7$(),t.SpI(" ",o.tipo_servicio," ")}}function z(e,n){1&e&&(t.j41(0,"th",40),t.EFF(1," Local "),t.k0s())}function W(e,n){if(1&e&&(t.j41(0,"td",41),t.EFF(1),t.k0s()),2&e){const o=n.$implicit;t.Y8G("matTooltip",o.local),t.R7$(),t.SpI(" ",o.local," ")}}function Z(e,n){1&e&&(t.j41(0,"th",40),t.EFF(1," Repuesto "),t.k0s())}function Q(e,n){if(1&e&&(t.j41(0,"td",42),t.EFF(1),t.k0s()),2&e){const o=n.$implicit;t.Y8G("matTooltip",o.repuesto),t.R7$(),t.SpI(" ",o.repuesto," ")}}function K(e,n){1&e&&(t.j41(0,"th",40),t.EFF(1," Cliente "),t.k0s())}function tt(e,n){if(1&e&&(t.j41(0,"td",42),t.EFF(1),t.k0s()),2&e){const o=n.$implicit;t.Y8G("matTooltip",o.cliente),t.R7$(),t.SpI(" ",o.cliente," ")}}function et(e,n){1&e&&(t.j41(0,"th",40),t.EFF(1," Cantidad "),t.k0s())}function ot(e,n){if(1&e&&(t.j41(0,"td",43),t.EFF(1),t.k0s()),2&e){const o=n.$implicit;t.R7$(),t.SpI(" ",o.cantidad," ")}}function nt(e,n){1&e&&(t.j41(0,"th",40),t.EFF(1," Precio\xa0compra "),t.k0s())}function it(e,n){if(1&e&&(t.j41(0,"td",43),t.EFF(1),t.k0s()),2&e){const o=n.$implicit;t.R7$(),t.SpI(" $",o.precio_compra," ")}}function at(e,n){1&e&&(t.j41(0,"th",40),t.EFF(1," Precio Venta "),t.k0s())}function rt(e,n){if(1&e&&(t.j41(0,"td",43),t.EFF(1),t.k0s()),2&e){const o=n.$implicit;t.R7$(),t.SpI(" $",o.precio_venta_cliente," ")}}function mt(e,n){1&e&&(t.j41(0,"th",40),t.EFF(1," Valor "),t.k0s())}function ct(e,n){if(1&e&&(t.j41(0,"td",43),t.EFF(1),t.k0s()),2&e){const o=n.$implicit;t.R7$(),t.SpI(" $",o.valor_cliente," ")}}function st(e,n){1&e&&(t.j41(0,"th",40),t.EFF(1," Fecha "),t.k0s())}function lt(e,n){if(1&e&&(t.j41(0,"td",44),t.EFF(1),t.nI1(2,"date"),t.k0s()),2&e){const o=n.$implicit;t.R7$(),t.SpI(" ",t.i5U(2,1,o.fechaVisita,"dd-MM-yyyy")," ")}}function ut(e,n){1&e&&(t.j41(0,"th",40),t.EFF(1," Visita T\xe9cnico "),t.k0s())}function pt(e,n){if(1&e&&(t.j41(0,"td",42),t.EFF(1),t.k0s()),2&e){const o=n.$implicit;t.Y8G("matTooltip",o.nombre_tecnico),t.R7$(),t.SpI(" ",o.nombre_tecnico," ")}}function ft(e,n){1&e&&t.nrm(0,"tr",45)}function dt(e,n){1&e&&t.nrm(0,"tr",46)}let ht=(()=>{class e{constructor(o,a,i){this.fb=o,this.storage=a,this.informeConsumoService=i,this.dataSource=new s.I6([]),this.firstoption=[],this.originalOptions=[],this.selectedCompanyName="",this.displayedColumns=["requerimiento","tipo_servicio","local","repuesto","cliente","cantidad","precio_compra","precio_venta_cliente","valor_cliente","fechaVisita","nombre_tecnico"],this.displayFn=r=>{if(!r)return"";if("TODOS"===r)return"TODOS";const m=this.user.companies.find(u=>u.id===r);return m?m.nombre:""},this.informeForm=this.fb.group({cliente:["",l.k0.required],fechaInicio:[null,l.k0.required],fechaFin:[null,l.k0.required]}),this.filteredOptions=this.informeForm.get("cliente").valueChanges.pipe((0,y.Z)(""),(0,x.T)(r=>r?this._filter(r):this.originalOptions))}ngOnInit(){this.storageSubscription=this.storage.user$.subscribe(o=>{o&&(this.user=o,this.firstoption=this.user.companies.filter(a=>"gruman"!==a.nombre.toLowerCase()).map(a=>a.nombre),this.originalOptions=[...this.firstoption])})}ngAfterViewInit(){this.dataSource.paginator=this.paginator}_filter(o){const a=o.toLowerCase();return this.originalOptions.filter(i=>i.toLowerCase().includes(a))}onCompanySelected(o){if(!o.option.value)return this.informeForm.patchValue({cliente:null}),void(this.selectedCompanyName="");if("TODOS"===o.option.value)return this.selectedCompanyName="TODOS",void this.informeForm.patchValue({cliente:"TODOS"});const a=this.user.companies.find(i=>i.nombre===o.option.value);this.selectedCompanyName=o.option.value,this.informeForm.patchValue({cliente:a?a.id:null})}setFilter(){if(this.informeForm.invalid)return void alert("Por favor, complete todos los campos requeridos");const{cliente:o,fechaInicio:a,fechaFin:i}=this.informeForm.value,r=this.formatDate(a),m=this.formatDate(i);this.informeConsumoService.getInformeConsumo(r,m,o).subscribe(u=>{this.dataSource.data=u[0]},u=>{console.error("Error al obtener el informe:",u)})}formatDate(o){return o.toISOString().split("T")[0]}clearClient(){this.informeForm.patchValue({cliente:null}),this.selectedCompanyName="",this.informeForm.get("cliente")?.setValue(""),this.filteredOptions=(0,Y.of)(this.originalOptions)}static#t=this.\u0275fac=function(a){return new(a||e)(t.rXU(l.ok),t.rXU(v.n),t.rXU(O))};static#e=this.\u0275cmp=t.VBU({type:e,selectors:[["app-informe-consumo"]],viewQuery:function(a,i){if(1&a&&t.GBs(I.iy,5),2&a){let r;t.mGM(r=t.lsd())&&(i.paginator=r.first)}},standalone:!0,features:[t.Jv_([{provide:F.Ju,useValue:"es-ES"},(0,F.aw)()]),t.aNF],decls:71,vars:19,consts:[["auto","matAutocomplete"],["pickerInicio",""],["pickerFin",""],[1,"cardWithShadow"],[1,"d-flex","justify-content-start","align-items-baseline","gap-5",3,"formGroup"],["appearance","outline"],["type","text","placeholder","Selecciona cliente","aria-label","Number","matInput","","formControlName","cliente",3,"matAutocomplete"],["mat-icon-button","","matSuffix","",3,"click",4,"ngIf"],["autoActiveFirstOption","",3,"optionSelected","displayWith"],[3,"value"],[4,"ngIf"],["appearance","outline",2,"margin","0 10px"],["matInput","","formControlName","fechaInicio",3,"matDatepicker"],["matIconSuffix","",3,"for"],["appearance","outline",2,"margin-right","10px"],["matInput","","formControlName","fechaFin",3,"matDatepicker"],["mat-raised-button","","color","primary",1,"mt-2",3,"click","disabled"],[1,"p-24"],[1,"table-responsive"],["mat-table","",1,"mat-elevation-z8","w-100",3,"dataSource"],["matColumnDef","requerimiento"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","","matTooltipPosition","above","class","text-truncate",3,"matTooltip",4,"matCellDef"],["matColumnDef","tipo_servicio"],["matColumnDef","local"],["matColumnDef","repuesto"],["mat-cell","","matTooltipPosition","above","class","text-truncate","style","max-width: 150px; white-space: nowrap;",3,"matTooltip",4,"matCellDef"],["matColumnDef","cliente"],["matColumnDef","cantidad"],["mat-cell","",4,"matCellDef"],["matColumnDef","precio_compra"],["matColumnDef","precio_venta_cliente"],["matColumnDef","valor_cliente"],["matColumnDef","fechaVisita"],["mat-cell","","matTooltipPosition","above","class","text-truncate","style","max-width: 150px; white-space: nowrap;",4,"matCellDef"],["matColumnDef","nombre_tecnico"],["mat-header-row","","class","w-100",4,"matHeaderRowDef"],["mat-row","","class","w-100",4,"matRowDef","matRowDefColumns"],["aria-label","Select page of users",1,"mt-10",3,"pageSizeOptions"],["mat-icon-button","","matSuffix","",3,"click"],["mat-header-cell",""],["mat-cell","","matTooltipPosition","above",1,"text-truncate",3,"matTooltip"],["mat-cell","","matTooltipPosition","above",1,"text-truncate",2,"max-width","150px","white-space","nowrap",3,"matTooltip"],["mat-cell",""],["mat-cell","","matTooltipPosition","above",1,"text-truncate",2,"max-width","150px","white-space","nowrap"],["mat-header-row","",1,"w-100"],["mat-row","",1,"w-100"]],template:function(a,i){if(1&a){const r=t.RV6();t.j41(0,"mat-card",3)(1,"mat-card-header")(2,"form",4)(3,"mat-form-field",5)(4,"mat-label"),t.EFF(5,"Selecciona cliente"),t.k0s(),t.nrm(6,"input",6),t.DNE(7,L,3,0,"button",7),t.j41(8,"mat-autocomplete",8,0),t.bIt("optionSelected",function(u){return t.eBV(r),t.Njj(i.onCompanySelected(u))}),t.Z7z(10,M,2,2,"mat-option",9,t.fX1),t.nI1(12,"async"),t.k0s(),t.DNE(13,U,2,0,"mat-error",10),t.k0s(),t.j41(14,"mat-form-field",11)(15,"mat-label"),t.EFF(16,"Fecha de inicio"),t.k0s(),t.nrm(17,"input",12)(18,"mat-datepicker-toggle",13)(19,"mat-datepicker",null,1),t.DNE(21,P,2,0,"mat-error",10),t.k0s(),t.j41(22,"mat-form-field",14)(23,"mat-label"),t.EFF(24,"Fecha de fin"),t.k0s(),t.nrm(25,"input",15)(26,"mat-datepicker-toggle",13)(27,"mat-datepicker",null,2),t.DNE(29,A,2,0,"mat-error",10),t.k0s(),t.j41(30,"button",16),t.bIt("click",function(){return t.eBV(r),t.Njj(i.setFilter())}),t.EFF(31," Buscar "),t.k0s()()(),t.j41(32,"mat-card-content",17)(33,"div",18)(34,"table",19),t.qex(35,20),t.DNE(36,B,2,0,"th",21)(37,X,2,2,"td",22),t.bVm(),t.qex(38,23),t.DNE(39,H,2,0,"th",21)(40,J,2,2,"td",22),t.bVm(),t.qex(41,24),t.DNE(42,z,2,0,"th",21)(43,W,2,2,"td",22),t.bVm(),t.qex(44,25),t.DNE(45,Z,2,0,"th",21)(46,Q,2,2,"td",26),t.bVm(),t.qex(47,27),t.DNE(48,K,2,0,"th",21)(49,tt,2,2,"td",26),t.bVm(),t.qex(50,28),t.DNE(51,et,2,0,"th",21)(52,ot,2,1,"td",29),t.bVm(),t.qex(53,30),t.DNE(54,nt,2,0,"th",21)(55,it,2,1,"td",29),t.bVm(),t.qex(56,31),t.DNE(57,at,2,0,"th",21)(58,rt,2,1,"td",29),t.bVm(),t.qex(59,32),t.DNE(60,mt,2,0,"th",21)(61,ct,2,1,"td",29),t.bVm(),t.qex(62,33),t.DNE(63,st,2,0,"th",21)(64,lt,3,4,"td",34),t.bVm(),t.qex(65,35),t.DNE(66,ut,2,0,"th",21)(67,pt,2,2,"td",26),t.bVm(),t.DNE(68,ft,1,0,"tr",36)(69,dt,1,0,"tr",37),t.k0s()(),t.nrm(70,"mat-paginator",38),t.k0s()()}if(2&a){let r,m,u,d;const k=t.sdS(9),j=t.sdS(20),V=t.sdS(28);t.R7$(2),t.Y8G("formGroup",i.informeForm),t.R7$(4),t.Y8G("matAutocomplete",k),t.R7$(),t.Y8G("ngIf",null==(r=i.informeForm.get("cliente"))?null:r.value),t.R7$(),t.Y8G("displayWith",i.displayFn),t.R7$(2),t.Dyx(t.bMT(12,16,i.filteredOptions)),t.R7$(3),t.Y8G("ngIf",null==(m=i.informeForm.get("cliente"))?null:m.hasError("required")),t.R7$(4),t.Y8G("matDatepicker",j),t.R7$(),t.Y8G("for",j),t.R7$(3),t.Y8G("ngIf",null==(u=i.informeForm.get("fechaInicio"))?null:u.hasError("required")),t.R7$(4),t.Y8G("matDatepicker",V),t.R7$(),t.Y8G("for",V),t.R7$(3),t.Y8G("ngIf",null==(d=i.informeForm.get("fechaFin"))?null:d.hasError("required")),t.R7$(),t.Y8G("disabled",i.informeForm.invalid),t.R7$(4),t.Y8G("dataSource",i.dataSource),t.R7$(34),t.Y8G("matHeaderRowDef",i.displayedColumns),t.R7$(),t.Y8G("matRowDefColumns",i.displayedColumns),t.R7$(),t.Y8G("pageSizeOptions",t.lJ4(18,q))}},dependencies:[p.MD,p.bT,p.Jj,p.vh,h.Hu,h.RN,h.m2,h.MM,s.tP,s.Zl,s.tL,s.ji,s.cC,s.YV,s.iL,s.KS,s.$R,s.YZ,s.NB,f.RG,f.rl,f.nJ,f.TL,f.yw,g.fS,g.fg,b.X6,b.Vh,b.bZ,b.bU,E.m_,E.An,C.Hl,C.$z,C.iY,l.YN,l.qT,l.me,l.BC,l.cb,_.jL,_.$3,F.wT,_.pN,l.X1,l.j4,l.JD,I.Ou,I.iy,S.uc,S.oV]})}return e})(),Ft=(()=>{class e{constructor(o){this.http=o}getMesFacturacion(o){return this.http.get(`${T.c.apiUrl}/facturacion/${o}`)}getInformeConsumoMesFacturacion(o,a){return this.http.get(`${T.c.apiUrl}/informe-mes-facturacion?companyId=${o}&mesFacturacion=${a}`)}static#t=this.\u0275fac=function(a){return new(a||e)(t.KVO($.Qq))};static#e=this.\u0275prov=t.jDH({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})();const Ct=()=>[5,10,25,100];function _t(e,n){if(1&e){const o=t.RV6();t.j41(0,"button",37),t.bIt("click",function(){t.eBV(o);const i=t.XpG();return t.Njj(i.clearClient())}),t.j41(1,"mat-icon"),t.EFF(2,"close"),t.k0s()()}}function It(e,n){if(1&e&&(t.j41(0,"mat-option",12),t.EFF(1),t.k0s()),2&e){const o=n.$implicit;t.Y8G("value",o.id),t.R7$(),t.SpI(" ",o.nombre," ")}}function bt(e,n){1&e&&(t.j41(0,"mat-error"),t.EFF(1," Campo requerido "),t.k0s())}function Tt(e,n){if(1&e){const o=t.RV6();t.j41(0,"button",37),t.bIt("click",function(){t.eBV(o);const i=t.XpG();return t.Njj(i.clearMes())}),t.j41(1,"mat-icon"),t.EFF(2,"close"),t.k0s()()}}function vt(e,n){if(1&e&&(t.j41(0,"mat-option",12),t.EFF(1),t.k0s()),2&e){const o=n.$implicit;t.Y8G("value",o),t.R7$(),t.SpI(" ",o.mes," ")}}function gt(e,n){1&e&&(t.j41(0,"mat-error"),t.EFF(1," Campo requerido "),t.k0s())}function Et(e,n){1&e&&(t.j41(0,"th",38),t.EFF(1,"Requerimiento"),t.k0s())}function St(e,n){if(1&e&&(t.j41(0,"td",39),t.EFF(1),t.k0s()),2&e){const o=n.$implicit;t.Y8G("matTooltip",o.requerimiento),t.R7$(),t.SpI(" ",o.requerimiento," ")}}function jt(e,n){1&e&&(t.j41(0,"th",38),t.EFF(1,"Servicio"),t.k0s())}function $t(e,n){if(1&e&&(t.j41(0,"td",39),t.EFF(1),t.k0s()),2&e){const o=n.$implicit;t.Y8G("matTooltip",o.tipo_servicio),t.R7$(),t.SpI(" ",o.tipo_servicio," ")}}function kt(e,n){1&e&&(t.j41(0,"th",38),t.EFF(1,"Local"),t.k0s())}function Rt(e,n){if(1&e&&(t.j41(0,"td",39),t.EFF(1),t.k0s()),2&e){const o=n.$implicit;t.Y8G("matTooltip",o.local),t.R7$(),t.SpI(" ",o.local," ")}}function Dt(e,n){1&e&&(t.j41(0,"th",38),t.EFF(1,"Repuesto"),t.k0s())}function yt(e,n){if(1&e&&(t.j41(0,"td",40),t.EFF(1),t.k0s()),2&e){const o=n.$implicit;t.Y8G("matTooltip",o.repuesto),t.R7$(),t.SpI(" ",o.repuesto," ")}}function xt(e,n){1&e&&(t.j41(0,"th",38),t.EFF(1,"Cliente"),t.k0s())}function Vt(e,n){if(1&e&&(t.j41(0,"td",40),t.EFF(1),t.k0s()),2&e){const o=n.$implicit;t.Y8G("matTooltip",o.cliente),t.R7$(),t.SpI(" ",o.cliente," ")}}function Nt(e,n){1&e&&(t.j41(0,"th",38),t.EFF(1,"Cantidad"),t.k0s())}function wt(e,n){if(1&e&&(t.j41(0,"td",41),t.EFF(1),t.k0s()),2&e){const o=n.$implicit;t.R7$(),t.JRh(o.cantidad)}}function Gt(e,n){1&e&&(t.j41(0,"th",38),t.EFF(1,"Precio\xa0compra"),t.k0s())}function Yt(e,n){if(1&e&&(t.j41(0,"td",41),t.EFF(1),t.k0s()),2&e){const o=n.$implicit;t.R7$(),t.SpI(" $",o.precio_compra," ")}}function Ot(e,n){1&e&&(t.j41(0,"th",38),t.EFF(1,"Precio Venta"),t.k0s())}function qt(e,n){if(1&e&&(t.j41(0,"td",41),t.EFF(1),t.nI1(2,"currency"),t.k0s()),2&e){const o=n.$implicit;t.R7$(),t.SpI(" $",t.ii3(2,1,o.precio_venta_cliente,"","symbol","1.0-0")," ")}}function Lt(e,n){1&e&&(t.j41(0,"th",38),t.EFF(1,"Valor"),t.k0s())}function Mt(e,n){if(1&e&&(t.j41(0,"td",41),t.EFF(1),t.k0s()),2&e){const o=n.$implicit;t.R7$(),t.SpI(" $",o.valor_cliente," ")}}function Ut(e,n){1&e&&(t.j41(0,"th",38),t.EFF(1,"Fecha"),t.k0s())}function Pt(e,n){if(1&e&&(t.j41(0,"td",42),t.EFF(1),t.nI1(2,"date"),t.k0s()),2&e){const o=n.$implicit;t.R7$(),t.SpI(" ",t.i5U(2,1,o.fechaVisita,"dd-MM-yyyy")," ")}}function At(e,n){1&e&&(t.j41(0,"th",38),t.EFF(1,"Mes Facturacion"),t.k0s())}function Bt(e,n){if(1&e&&(t.j41(0,"td",41),t.EFF(1),t.k0s()),2&e){const o=n.$implicit;t.R7$(),t.SpI(" ",o.mes_facturacion," ")}}function Xt(e,n){1&e&&(t.j41(0,"th",38),t.EFF(1,"Visita T\xe9cnico"),t.k0s())}function Ht(e,n){if(1&e&&(t.j41(0,"td",40),t.EFF(1),t.k0s()),2&e){const o=n.$implicit;t.Y8G("matTooltip",o.nombre_tecnico),t.R7$(),t.SpI(" ",o.nombre_tecnico," ")}}function Jt(e,n){1&e&&t.nrm(0,"tr",43)}function zt(e,n){1&e&&t.nrm(0,"tr",44)}const Wt=[{path:"reporte-de-activos",component:G,data:{title:"Reportes de activos"}},{path:"repuestos-por-dia",component:ht,data:{title:"Reporte de repuestos por d\xeda"}},{path:"repuestos-por-mes",component:(()=>{class e{constructor(o,a,i,r){this.fb=o,this.storage=a,this.informeConsumoService=i,this.storageService=r,this.dataSource=new s.I6([]),this.hasGruman=!1,this.firstoption=[],this.originalOptions=[],this.selectedCompanyName="",this.mesFacturacionList=[],this.displayedColumns=["requerimiento","tipo_servicio","local","repuesto","cliente","cantidad","precio_compra","precio_venta_cliente","valor_cliente","fechaVisita","mes_facturacion","nombre_tecnico"],this.displayFn=m=>{const u=this.originalOptions.find(d=>d.id===m);return u?u.nombre:""},this.displayMesFn=m=>{if(!m)return"";if("object"==typeof m)return m.mes;const u=this.mesFacturacionList.find(d=>d.id===m);return u?u.mes:""},this.informeForm=this.fb.group({cliente:["",l.k0.required],mesFacturacion:[{value:null,disabled:!0},l.k0.required]}),this.filteredOptions=this.informeForm.get("cliente").valueChanges.pipe((0,y.Z)(""),(0,x.T)(m=>m?this._filter(m):this.originalOptions))}ngOnInit(){this.storageSubscription=this.storage.user$.subscribe(o=>{o&&(this.user=o,this.hasGruman="gruman"===this.selectedCompanyName.toLowerCase(),this.firstoption=this.user.companies.filter(a=>"gruman"!==a.nombre.toLowerCase()),this.originalOptions=[...this.firstoption])})}ngAfterViewInit(){this.dataSource.paginator=this.paginator}_filter(o){const a=o.toLowerCase();return this.originalOptions.filter(i=>"gruman"!==i.nombre.toLowerCase()&&i.nombre.toLowerCase().includes(a))}onCompanySelected(o){if(!o.option.value)return this.informeForm.patchValue({cliente:null}),this.selectedCompanyName="",void this.informeForm.get("mesFacturacion")?.disable();this.informeConsumoService.getMesFacturacion(o.option.value).subscribe(a=>{this.mesFacturacionList=a,this.informeForm.get("mesFacturacion")?.enable()}),this.selectedCompanyName=o.option.value}onMesFacturacionSelected(o){const a=o.option.value,i=this.mesFacturacionList.find(r=>r.mes===a);this.informeForm.patchValue({mesFacturacion:i.id})}setFilter(){if(this.informeForm.invalid)return void alert("Por favor, complete todos los campos requeridos");const{cliente:o,mesFacturacion:a}=this.informeForm.value;this.informeConsumoService.getInformeConsumoMesFacturacion(o,a.id_facturacion).subscribe(i=>{this.dataSource.data=i[0]},i=>{console.error("Error al obtener el informe:",i)})}formatDate(o){return o.toISOString().split("T")[0]}clearClient(){this.informeForm.patchValue({cliente:null}),this.selectedCompanyName="",this.informeForm.get("cliente")?.setValue(""),this.informeForm.get("mesFacturacion")?.disable()}clearMes(){this.informeForm.patchValue({mesFacturacion:null}),this.selectedCompanyName="",this.informeForm.get("mesFacturacion")?.setValue("")}static#t=this.\u0275fac=function(a){return new(a||e)(t.rXU(l.ok),t.rXU(v.n),t.rXU(Ft),t.rXU(v.n))};static#e=this.\u0275cmp=t.VBU({type:e,selectors:[["app-informe-consumo-facturacion"]],viewQuery:function(a,i){if(1&a&&t.GBs(I.iy,5),2&a){let r;t.mGM(r=t.lsd())&&(i.paginator=r.first)}},standalone:!0,features:[t.Jv_([{provide:F.Ju,useValue:"es-ES"},(0,F.aw)()]),t.aNF],decls:67,vars:19,consts:[["auto","matAutocomplete"],["mesFacturacion","matAutocomplete"],[1,"cardWithShadow"],[1,"d-flex","align-items-baseline","gap-10",3,"formGroup"],["appearance","outline"],["type","text","placeholder","Selecciona cliente","aria-label","Number","matInput","","formControlName","cliente",3,"matAutocomplete"],["mat-icon-button","","matSuffix","",3,"click",4,"ngIf"],[3,"optionSelected","autoActiveFirstOption","displayWith"],[3,"value",4,"ngFor","ngForOf"],[4,"ngIf"],["type","text","placeholder","Selecciona un mes","aria-label","Number","matInput","","formControlName","mesFacturacion",3,"matAutocomplete"],["autoActiveFirstOption","",3,"optionSelected","displayWith"],[3,"value"],["mat-raised-button","","color","primary",1,"mt-2",3,"click","disabled"],[1,"p-24"],[1,"table-responsive"],["mat-table","",1,"mat-elevation-z8","w-100",3,"dataSource"],["matColumnDef","requerimiento"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","","matTooltipPosition","above","class","text-truncate",3,"matTooltip",4,"matCellDef"],["matColumnDef","tipo_servicio"],["matColumnDef","local"],["matColumnDef","repuesto"],["mat-cell","","matTooltipPosition","above","class","text-truncate","style","max-width: 150px; white-space: nowrap",3,"matTooltip",4,"matCellDef"],["matColumnDef","cliente"],["matColumnDef","cantidad"],["mat-cell","",4,"matCellDef"],["matColumnDef","precio_compra"],["matColumnDef","precio_venta_cliente"],["matColumnDef","valor_cliente"],["matColumnDef","fechaVisita"],["mat-cell","","matTooltipPosition","above","class","text-truncate","style","max-width: 150px; white-space: nowrap",4,"matCellDef"],["matColumnDef","mes_facturacion"],["matColumnDef","nombre_tecnico"],["mat-header-row","","class","w-100",4,"matHeaderRowDef"],["mat-row","","class","w-100",4,"matRowDef","matRowDefColumns"],["aria-label","Select page of users",1,"mt-10",3,"pageSizeOptions"],["mat-icon-button","","matSuffix","",3,"click"],["mat-header-cell",""],["mat-cell","","matTooltipPosition","above",1,"text-truncate",3,"matTooltip"],["mat-cell","","matTooltipPosition","above",1,"text-truncate",2,"max-width","150px","white-space","nowrap",3,"matTooltip"],["mat-cell",""],["mat-cell","","matTooltipPosition","above",1,"text-truncate",2,"max-width","150px","white-space","nowrap"],["mat-header-row","",1,"w-100"],["mat-row","",1,"w-100"]],template:function(a,i){if(1&a){const r=t.RV6();t.j41(0,"mat-card",2)(1,"mat-card-header")(2,"form",3)(3,"mat-form-field",4)(4,"mat-label"),t.EFF(5,"Selecciona cliente"),t.k0s(),t.nrm(6,"input",5),t.DNE(7,_t,3,0,"button",6),t.j41(8,"mat-autocomplete",7,0),t.bIt("optionSelected",function(u){return t.eBV(r),t.Njj(i.onCompanySelected(u))}),t.DNE(10,It,2,2,"mat-option",8),t.nI1(11,"async"),t.k0s(),t.DNE(12,bt,2,0,"mat-error",9),t.k0s(),t.j41(13,"mat-form-field",4)(14,"mat-label"),t.EFF(15,"Selecciona mes facturacion"),t.k0s(),t.nrm(16,"input",10),t.DNE(17,Tt,3,0,"button",6),t.j41(18,"mat-autocomplete",11,1),t.bIt("optionSelected",function(u){return t.eBV(r),t.Njj(i.onMesFacturacionSelected(u))}),t.Z7z(20,vt,2,2,"mat-option",12,t.fX1),t.k0s(),t.DNE(22,gt,2,0,"mat-error",9),t.k0s(),t.j41(23,"button",13),t.bIt("click",function(){return t.eBV(r),t.Njj(i.setFilter())}),t.EFF(24," Buscar "),t.k0s()()(),t.j41(25,"mat-card-content",14)(26,"div",15)(27,"table",16),t.qex(28,17),t.DNE(29,Et,2,0,"th",18)(30,St,2,2,"td",19),t.bVm(),t.qex(31,20),t.DNE(32,jt,2,0,"th",18)(33,$t,2,2,"td",19),t.bVm(),t.qex(34,21),t.DNE(35,kt,2,0,"th",18)(36,Rt,2,2,"td",19),t.bVm(),t.qex(37,22),t.DNE(38,Dt,2,0,"th",18)(39,yt,2,2,"td",23),t.bVm(),t.qex(40,24),t.DNE(41,xt,2,0,"th",18)(42,Vt,2,2,"td",23),t.bVm(),t.qex(43,25),t.DNE(44,Nt,2,0,"th",18)(45,wt,2,1,"td",26),t.bVm(),t.qex(46,27),t.DNE(47,Gt,2,0,"th",18)(48,Yt,2,1,"td",26),t.bVm(),t.qex(49,28),t.DNE(50,Ot,2,0,"th",18)(51,qt,3,6,"td",26),t.bVm(),t.qex(52,29),t.DNE(53,Lt,2,0,"th",18)(54,Mt,2,1,"td",26),t.bVm(),t.qex(55,30),t.DNE(56,Ut,2,0,"th",18)(57,Pt,3,4,"td",31),t.bVm(),t.qex(58,32),t.DNE(59,At,2,0,"th",18)(60,Bt,2,1,"td",26),t.bVm(),t.qex(61,33),t.DNE(62,Xt,2,0,"th",18)(63,Ht,2,2,"td",23),t.bVm(),t.DNE(64,Jt,1,0,"tr",34)(65,zt,1,0,"tr",35),t.k0s()(),t.nrm(66,"mat-paginator",36),t.k0s()()}if(2&a){let r,m,u,d;const k=t.sdS(9),j=t.sdS(19);t.R7$(2),t.Y8G("formGroup",i.informeForm),t.R7$(4),t.Y8G("matAutocomplete",k),t.R7$(),t.Y8G("ngIf",null==(r=i.informeForm.get("cliente"))?null:r.value),t.R7$(),t.Y8G("autoActiveFirstOption",!0)("displayWith",i.displayFn),t.R7$(2),t.Y8G("ngForOf",t.bMT(11,16,i.filteredOptions)),t.R7$(2),t.Y8G("ngIf",null==(m=i.informeForm.get("cliente"))?null:m.hasError("required")),t.R7$(4),t.Y8G("matAutocomplete",j),t.R7$(),t.Y8G("ngIf",null==(u=i.informeForm.get("cliente"))?null:u.value),t.R7$(),t.Y8G("displayWith",i.displayMesFn),t.R7$(2),t.Dyx(i.mesFacturacionList),t.R7$(2),t.Y8G("ngIf",null==(d=i.informeForm.get("mesFacturacion"))?null:d.hasError("required")),t.R7$(),t.Y8G("disabled",i.informeForm.invalid),t.R7$(4),t.Y8G("dataSource",i.dataSource),t.R7$(37),t.Y8G("matHeaderRowDef",i.displayedColumns),t.R7$(),t.Y8G("matRowDefColumns",i.displayedColumns),t.R7$(),t.Y8G("pageSizeOptions",t.lJ4(18,Ct))}},dependencies:[p.MD,p.Sq,p.bT,p.Jj,p.oe,p.vh,h.Hu,h.RN,h.m2,h.MM,s.tP,s.Zl,s.tL,s.ji,s.cC,s.YV,s.iL,s.KS,s.$R,s.YZ,s.NB,f.RG,f.rl,f.nJ,f.TL,f.yw,g.fS,g.fg,b.X6,E.m_,E.An,C.Hl,C.$z,C.iY,l.YN,l.qT,l.me,l.BC,l.cb,_.jL,_.$3,F.wT,_.pN,l.X1,l.j4,l.JD,I.Ou,I.iy,S.uc,S.oV]})}return e})(),data:{title:"Reporte de repuestos por mes"}}]}}]);