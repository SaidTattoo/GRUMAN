"use strict";(self.webpackChunkSpike=self.webpackChunkSpike||[]).push([[8459],{8459:(M,S,c)=>{c.r(S),c.d(S,{LISTADO_SOLICITUD_APROBACION_CORRECTIVA_ROUTES:()=>z});var b=c(177),n=c(9417),u=c(8834),m=c(5596),h=c(6600),g=c(5084),p=c(3719),C=c(9213),f=c(9631),F=c(2798),t=c(3953),j=c(4683),k=c(8949),I=c(5602),A=c(390),E=c(6431);function _(o,r){if(1&o&&(t.j41(0,"mat-option",21),t.EFF(1),t.k0s()),2&o){const i=r.$implicit;t.Y8G("value",i.id),t.R7$(),t.SpI(" ",i.name," ")}}function R(o,r){if(1&o&&(t.j41(0,"mat-option",21),t.EFF(1),t.k0s()),2&o){const i=r.$implicit;t.Y8G("value",i.id),t.R7$(),t.SpI(" ",i.numeroLocal," ")}}function T(o,r){if(1&o&&(t.j41(0,"mat-option",21),t.EFF(1),t.k0s()),2&o){const i=r.$implicit;t.Y8G("value",i.id),t.R7$(),t.SpI(" ",i.nombre," ")}}function L(o,r){if(1&o&&(t.j41(0,"mat-option",21),t.EFF(1),t.k0s()),2&o){const i=r.$implicit;t.Y8G("value",i.id),t.R7$(),t.SpI(" ",i.nombre," ")}}function N(o,r){if(1&o&&(t.j41(0,"mat-option",21),t.EFF(1),t.k0s()),2&o){const i=r.$implicit;t.Y8G("value",i.id),t.R7$(),t.SpI(" ",i.nombre," ")}}function $(o,r){1&o&&(t.j41(0,"mat-error"),t.EFF(1," Solo se permiten n\xfameros. "),t.k0s())}function D(o,r){if(1&o&&(t.j41(0,"mat-option",21),t.EFF(1),t.k0s()),2&o){const i=r.$implicit;t.Y8G("value",i),t.R7$(),t.SpI(" ",i," ")}}let G=(()=>{class o{constructor(i,e,a,l,d,v){this.fb=i,this.serviciosService=e,this.localesService=a,this.usersService=l,this.uploadDataService=d,this.listadoSolicitudAprobacionCorrectivaService=v,this.inspectores=[],this.locales=[],this.especialidades=[],this.criticidades=[{id:1,nombre:"Alta"},{id:2,nombre:"Media"},{id:3,nombre:"Baja"}],this.afectas=[{id:1,nombre:"Seguridad"},{id:2,nombre:"Servicio"},{id:3,nombre:"Calidad"}],this.tiempos=[],this.loading=!1,this.tiempos=Array.from({length:720},(K,J)=>J+1)}ngOnInit(){this.programacionForm=this.fb.group({inspectorId:[null,n.k0.required],numeroLocal:[null,n.k0.required],especialidad:[null,n.k0.required],criticidad:[null,n.k0.required],costoEstimado:[null,[n.k0.required,n.k0.pattern(/^\$?[0-9]+(\.[0-9]{3})*$/)]],observaciones:[null,n.k0.required],afecta:[null,n.k0.required],tiempoEstimado:[null,n.k0.required],file:[null,n.k0.required]}),this.servicios(),this.getLocales(),this.getUsers()}getUsers(){this.usersService.getUsers().subscribe(i=>{this.inspectores=i})}getLocales(){this.localesService.getLocales().subscribe(i=>{this.locales=i})}servicios(){this.serviciosService.getAllServicios().subscribe(i=>{this.especialidades=i})}formatCurrency(){const i=this.programacionForm.get("costoEstimado");if(i){const e=parseInt(i.value.replace(/[^0-9]+/g,""),10);isNaN(e)?i.setValue(""):i.setValue(`$${e.toLocaleString("de-DE")}`)}}onSubmit(){const i=this.programacionForm.value.file,e=new FormData;e.append("nombre",this.programacionForm.value.nombre),e.append("tipoDocumento",this.programacionForm.value.tipoDocumento),e.append("file",i),this.uploadDataService.uploadFile(e,"solicitud-aprobacion-correctiva").subscribe(a=>{const l=a.url,d={...this.programacionForm.value};d.costoEstimado&&(d.costoEstimado=parseInt(d.costoEstimado.replace(/[^0-9]+/g,""),10)),d.file=l,this.listadoSolicitudAprobacionCorrectivaService.createSolicitudAprobacionCorrectiva(d).subscribe(v=>{})})}onFileSelected(i){const e=i.target.files[0];e&&(this.programacionForm.patchValue({file:e}),this.programacionForm.get("file")?.updateValueAndValidity())}static#t=this.\u0275fac=function(e){return new(e||o)(t.rXU(n.ok),t.rXU(j.P),t.rXU(k.R),t.rXU(I.g),t.rXU(A.l),t.rXU(E.Y))};static#i=this.\u0275cmp=t.VBU({type:o,selectors:[["app-editar-solicitud-correctiva"]],standalone:!0,features:[t.aNF],decls:78,vars:10,consts:[[1,"cardWithShadow"],[1,"p-24"],[3,"ngSubmit","formGroup"],[1,"row"],[1,"col-sm-4","d-flex","align-items-center"],[1,"mat-subtitle-2","f-w-600","d-block","m-b-16"],[1,"col-sm-8"],["appearance","outline",1,"w-100"],["formControlName","inspectorId","placeholder","Seleccionar Inspector"],[3,"value",4,"ngFor","ngForOf"],["formControlName","numeroLocal","placeholder","Seleccionar N\xfamero Local"],["formControlName","especialidad","placeholder","Seleccionar Especialidad"],["formControlName","criticidad","placeholder","Seleccionar Criticidad"],["formControlName","afecta","placeholder","Seleccionar Afecta a"],["matInput","","formControlName","costoEstimado","placeholder","Ingrese Costo Estimado",3,"blur"],[4,"ngIf"],["formControlName","tiempoEstimado","placeholder","Seleccionar Tiempo Estimado"],["matInput","","formControlName","observaciones","placeholder","Ingrese observaciones","rows","4"],["type","file","accept",".png, .jpg, .jpeg",3,"change"],[1,"row","justify-content-end"],["mat-raised-button","","color","primary","type","submit",3,"disabled"],[3,"value"]],template:function(e,a){if(1&e&&(t.j41(0,"mat-card",0)(1,"mat-card-content",1)(2,"form",2),t.bIt("ngSubmit",function(){return a.onSubmit()}),t.j41(3,"div",3)(4,"div",4)(5,"mat-label",5),t.EFF(6,"Nombre Inspector"),t.k0s()(),t.j41(7,"div",6)(8,"mat-form-field",7)(9,"mat-select",8),t.DNE(10,_,2,2,"mat-option",9),t.k0s()()()(),t.j41(11,"div",3)(12,"div",4)(13,"mat-label",5),t.EFF(14,"N\xfamero Local"),t.k0s()(),t.j41(15,"div",6)(16,"mat-form-field",7)(17,"mat-select",10),t.DNE(18,R,2,2,"mat-option",9),t.k0s()()()(),t.j41(19,"div",3)(20,"div",4)(21,"mat-label",5),t.EFF(22,"Especialidad"),t.k0s()(),t.j41(23,"div",6)(24,"mat-form-field",7)(25,"mat-select",11),t.DNE(26,T,2,2,"mat-option",9),t.k0s()()()(),t.j41(27,"div",3)(28,"div",4)(29,"mat-label",5),t.EFF(30,"Criticidad"),t.k0s()(),t.j41(31,"div",6)(32,"mat-form-field",7)(33,"mat-select",12),t.DNE(34,L,2,2,"mat-option",9),t.k0s()()()(),t.j41(35,"div",3)(36,"div",4)(37,"mat-label",5),t.EFF(38,"Afecta a"),t.k0s()(),t.j41(39,"div",6)(40,"mat-form-field",7)(41,"mat-select",13),t.DNE(42,N,2,2,"mat-option",9),t.k0s()()()(),t.j41(43,"div",3)(44,"div",4)(45,"mat-label",5),t.EFF(46,"Costo Estimado"),t.k0s()(),t.j41(47,"div",6)(48,"mat-form-field",7)(49,"input",14),t.bIt("blur",function(){return a.formatCurrency()}),t.k0s(),t.DNE(50,$,2,0,"mat-error",15),t.k0s()()(),t.j41(51,"div",3)(52,"div",4)(53,"mat-label",5),t.EFF(54,"Tiempo Estimado"),t.k0s()(),t.j41(55,"div",6)(56,"mat-form-field",7)(57,"mat-select",16),t.DNE(58,D,2,2,"mat-option",9),t.k0s()()()(),t.j41(59,"div",3)(60,"div",4)(61,"mat-label",5),t.EFF(62,"Observaciones"),t.k0s()(),t.j41(63,"div",6)(64,"mat-form-field",7),t.nrm(65,"textarea",17),t.k0s()()(),t.j41(66,"div",3)(67,"div",4)(68,"mat-label",5),t.EFF(69,"Subir Im\xe1genes"),t.k0s()(),t.j41(70,"div",6)(71,"input",18),t.bIt("change",function(d){return a.onFileSelected(d)}),t.k0s(),t.j41(72,"small"),t.EFF(73,"Formato de im\xe1genes admitido png, jpg, jpeg"),t.k0s()()(),t.j41(74,"div",19)(75,"div",6)(76,"button",20),t.EFF(77),t.k0s()()()()()()),2&e){let l;t.R7$(2),t.Y8G("formGroup",a.programacionForm),t.R7$(8),t.Y8G("ngForOf",a.inspectores),t.R7$(8),t.Y8G("ngForOf",a.locales),t.R7$(8),t.Y8G("ngForOf",a.especialidades),t.R7$(8),t.Y8G("ngForOf",a.criticidades),t.R7$(8),t.Y8G("ngForOf",a.afectas),t.R7$(8),t.Y8G("ngIf",null==(l=a.programacionForm.get("costoEstimado"))?null:l.hasError("pattern")),t.R7$(8),t.Y8G("ngForOf",a.tiempos),t.R7$(18),t.Y8G("disabled",a.loading),t.R7$(),t.SpI(" ",a.loading?"Enviando...":"Enviar"," ")}},dependencies:[b.MD,b.Sq,b.bT,f.fS,f.fg,p.rl,p.nJ,p.TL,n.YN,n.qT,n.me,n.BC,n.cb,n.X1,n.j4,n.JD,m.Hu,m.RN,m.m2,p.RG,F.Ve,F.VO,h.wT,u.Hl,u.$z,C.m_,g.X6,h.WX]})}return o})();var s=c(9159),V=c(8887);function Y(o,r){1&o&&(t.j41(0,"th",18),t.EFF(1," ID "),t.k0s())}function y(o,r){if(1&o&&(t.j41(0,"td",19),t.EFF(1),t.k0s()),2&o){const i=r.$implicit;t.R7$(),t.SpI(" ",i.id," ")}}function O(o,r){1&o&&(t.j41(0,"th",18),t.EFF(1," Inspector "),t.k0s())}function U(o,r){if(1&o&&(t.j41(0,"td",19),t.EFF(1),t.k0s()),2&o){const i=r.$implicit;t.R7$(),t.Lme(" ",i.inspectorId.name," ",i.inspectorId.lastName," ")}}function w(o,r){1&o&&(t.j41(0,"th",18),t.EFF(1," N\xfamero Local "),t.k0s())}function X(o,r){if(1&o&&(t.j41(0,"td",19),t.EFF(1),t.k0s()),2&o){const i=r.$implicit;t.R7$(),t.SpI(" ",i.numeroLocal," ")}}function B(o,r){1&o&&(t.j41(0,"th",18),t.EFF(1," Acciones "),t.k0s())}function H(o,r){if(1&o){const i=t.RV6();t.j41(0,"td",19)(1,"button",20),t.bIt("click",function(){const a=t.eBV(i).$implicit,l=t.XpG();return t.Njj(l.editar(a))}),t.j41(2,"mat-icon"),t.EFF(3,"edit"),t.k0s()(),t.j41(4,"button",21),t.bIt("click",function(){const a=t.eBV(i).$implicit,l=t.XpG();return t.Njj(l.eliminar(a))}),t.j41(5,"mat-icon"),t.EFF(6,"delete"),t.k0s()()()}}function P(o,r){1&o&&t.nrm(0,"tr",22)}function W(o,r){1&o&&t.nrm(0,"tr",23)}const z=[{path:"",component:(()=>{class o{constructor(i){this.listadoSolicitudAprobacionCorrectivaService=i,this.router=(0,t.WQX)(V.Ix),this.displayedColumns=["id","inspectorId","numeroLocal","acciones"],this.dataSource=new s.I6}ngOnInit(){this.listarSolicitudes()}applyFilter(i){this.dataSource.filter=i.target.value.trim().toLowerCase()}editar(i){this.router.navigate(["/transacciones/listado-solicitud-aprobacion-correctiva/editar-solicitud-aprobacion-correctiva",i.id])}eliminar(i){this.listadoSolicitudAprobacionCorrectivaService.removeSolicitudAprobacionCorrectiva(i.id).subscribe(e=>{this.listarSolicitudes()})}listarSolicitudes(){this.listadoSolicitudAprobacionCorrectivaService.findAllSolicitudesAprobacionCorrectiva().subscribe(i=>{this.dataSource=new s.I6(i)})}crearSolicitud(){this.router.navigate(["/transacciones/solicitud-aprobacion-correctiva"])}static#t=this.\u0275fac=function(e){return new(e||o)(t.rXU(E.Y))};static#i=this.\u0275cmp=t.VBU({type:o,selectors:[["app-listado-solicitud-aprobacion-correctiva"]],standalone:!0,features:[t.aNF],decls:26,vars:3,consts:[["input",""],[1,"cardWithShadow"],[1,"p-24"],[1,"row","justify-content-between","m-b-8"],[1,"col-sm-4","col-lg-3"],["mat-flat-button","","color","primary",3,"click"],["appearance","outline",1,"w-100","hide-hint"],["matInput","","placeholder","Buscar",3,"keyup"],[1,"table-responsive","m-t-30"],["mat-table","",1,"w-100","mat-elevation-z8",3,"dataSource"],["matColumnDef","id"],["mat-header-cell","","class","f-w-600 mat-subtitle-1 f-s-14 p-l-0",4,"matHeaderCellDef"],["mat-cell","","class","p-l-0",4,"matCellDef"],["matColumnDef","inspectorId"],["matColumnDef","numeroLocal"],["matColumnDef","acciones"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["mat-header-cell","",1,"f-w-600","mat-subtitle-1","f-s-14","p-l-0"],["mat-cell","",1,"p-l-0"],["mat-icon-button","","color","primary","disabled","true",3,"click"],["mat-icon-button","","color","warn",3,"click"],["mat-header-row",""],["mat-row",""]],template:function(e,a){if(1&e){const l=t.RV6();t.j41(0,"mat-card",1)(1,"mat-card-content",2)(2,"div",3)(3,"div",4)(4,"button",5),t.bIt("click",function(){return t.eBV(l),t.Njj(a.crearSolicitud())}),t.EFF(5,"Nuevo Tipo de Activo"),t.k0s()(),t.j41(6,"div",4)(7,"mat-form-field",6)(8,"input",7,0),t.bIt("keyup",function(v){return t.eBV(l),t.Njj(a.applyFilter(v))}),t.k0s()()()(),t.j41(10,"div",8)(11,"table",9),t.qex(12,10),t.DNE(13,Y,2,0,"th",11)(14,y,2,1,"td",12),t.bVm(),t.qex(15,13),t.DNE(16,O,2,0,"th",11)(17,U,2,2,"td",12),t.bVm(),t.qex(18,14),t.DNE(19,w,2,0,"th",11)(20,X,2,1,"td",12),t.bVm(),t.qex(21,15),t.DNE(22,B,2,0,"th",11)(23,H,7,0,"td",12),t.bVm(),t.DNE(24,P,1,0,"tr",16)(25,W,1,0,"tr",17),t.k0s()()()()}2&e&&(t.R7$(11),t.Y8G("dataSource",a.dataSource),t.R7$(13),t.Y8G("matHeaderRowDef",a.displayedColumns),t.R7$(),t.Y8G("matRowDefColumns",a.displayedColumns))},dependencies:[s.tP,s.Zl,s.tL,s.ji,s.cC,s.YV,s.iL,s.KS,s.$R,s.YZ,s.NB,p.RG,p.rl,f.fS,f.fg,m.Hu,m.RN,m.m2,C.m_,C.An,u.Hl,u.$z,u.iY]})}return o})(),data:{title:"Listado de solicitudes de aprobaci\xf3n de actividad correctiva"}},{path:"editar-solicitud-aprobacion-correctiva/:id",component:G,data:{title:"Editar solicitud de aprobaci\xf3n de actividad correctiva"}}]}}]);