"use strict";(self.webpackChunkSpike=self.webpackChunkSpike||[]).push([[2212],{2212:(Q,M,i)=>{i.r(M),i.d(M,{CAUSA_RAIZ_ROUTES:()=>A});var F=i(4006),R=i(6695),g=i(5416),b=i(2042),c=i(9159),C=i(446),P=i(6801),p=i(8834),O=i(9213),u=i(3719),z=i(177),f=i(9631),v=i(4823),_=i(9183),m=i(5596),a=i(3953),x=i(1626),h=i(8887);const y=()=>[5,10,25,100];function k(e,l){1&e&&(a.j41(0,"th",19),a.EFF(1," Nombre "),a.k0s())}function j(e,l){if(1&e&&(a.j41(0,"td",20),a.EFF(1),a.k0s()),2&e){const t=l.$implicit;a.R7$(),a.SpI(" ",t.nombre," ")}}function S(e,l){1&e&&(a.j41(0,"th",21),a.EFF(1," Acciones "),a.k0s())}function T(e,l){if(1&e){const t=a.RV6();a.j41(0,"td",20)(1,"button",22),a.bIt("click",function(){const n=a.eBV(t).$implicit,o=a.XpG();return a.Njj(o.editarCausaRaiz(n))}),a.j41(2,"mat-icon"),a.EFF(3,"edit"),a.k0s()(),a.j41(4,"button",23),a.bIt("click",function(){const n=a.eBV(t).$implicit,o=a.XpG();return a.Njj(o.eliminarCausaRaiz(n))}),a.j41(5,"mat-icon"),a.EFF(6,"delete"),a.k0s()()()}}function I(e,l){1&e&&a.nrm(0,"tr",24)}function w(e,l){1&e&&a.nrm(0,"tr",25)}function G(e,l){if(1&e&&(a.j41(0,"tr",26)(1,"td",27),a.EFF(2),a.k0s()()),2&e){a.XpG();const t=a.sdS(9);a.R7$(2),a.SpI('No se encontraron datos que coincidan con el filtro "',t.value,'"')}}let $=(()=>{class e{constructor(t,r,n,o){this.http=t,this.router=r,this.dialog=n,this.snackBar=o,this.displayedColumns=["nombre","acciones"],this.loading=!1,this.dataSource=new c.I6([])}ngOnInit(){this.loadCausasRaiz()}ngAfterViewInit(){this.dataSource&&(this.dataSource.paginator=this.paginator,this.dataSource.sort=this.sort)}loadCausasRaiz(){this.loading=!0,this.http.get(`${C.c.apiUrl}causas-raiz`).subscribe({next:t=>{this.dataSource.data=t,this.loading=!1},error:t=>{console.error("Error al cargar causas ra\xedz:",t),this.snackBar.open("Error al cargar causas ra\xedz","Cerrar",{duration:3e3}),this.loading=!1}})}applyFilter(t){this.dataSource.filter=t.target.value.trim().toLowerCase(),this.dataSource.paginator&&this.dataSource.paginator.firstPage()}crearCausaRaiz(){this.router.navigate(["/mantenedores/causa-raiz/crear"])}editarCausaRaiz(t){this.router.navigate([`/mantenedores/causa-raiz/editar/${t.id}`])}eliminarCausaRaiz(t){this.dialog.open(P.w,{width:"350px",data:{title:"Confirmar eliminaci\xf3n",message:`\xbfEst\xe1 seguro que desea eliminar la causa ra\xedz "${t.nombre}"?`}}).afterClosed().subscribe(n=>{n&&this.http.delete(`${C.c.apiUrl}causas-raiz/${t.id}`).subscribe({next:()=>{this.snackBar.open("Causa ra\xedz eliminada correctamente","Cerrar",{duration:3e3}),this.loadCausasRaiz()},error:o=>{console.error("Error al eliminar causa ra\xedz:",o),this.snackBar.open("Error al eliminar causa ra\xedz","Cerrar",{duration:3e3})}})})}static#a=this.\u0275fac=function(r){return new(r||e)(a.rXU(x.Qq),a.rXU(h.Ix),a.rXU(F.bZ),a.rXU(g.UG))};static#t=this.\u0275cmp=a.VBU({type:e,selectors:[["app-causa-raiz"]],viewQuery:function(r,n){if(1&r&&(a.GBs(R.iy,5),a.GBs(b.B4,5)),2&r){let o;a.mGM(o=a.lsd())&&(n.paginator=o.first),a.mGM(o=a.lsd())&&(n.sort=o.first)}},standalone:!0,features:[a.aNF],decls:22,vars:5,consts:[["input",""],[1,"cardWithShadow"],[1,"p-24"],[1,"row","justify-content-between","m-b-8"],[1,"col-sm-4","col-lg-3"],["mat-flat-button","","color","primary",3,"click"],["appearance","outline",1,"w-100","hide-hint"],["matInput","","placeholder","Buscar causa ra\xedz...",3,"keyup"],[1,"table-responsive","m-t-30"],["mat-table","","matSort","",1,"w-100","mat-elevation-z8",3,"dataSource"],["matColumnDef","nombre"],["mat-header-cell","","mat-sort-header","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","acciones"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["class","mat-row",4,"matNoDataRow"],["aria-label","Selecciona p\xe1gina de causas ra\xedz",3,"pageSizeOptions"],["mat-header-cell","","mat-sort-header",""],["mat-cell",""],["mat-header-cell",""],["mat-icon-button","","color","primary","matTooltip","Editar",3,"click"],["mat-icon-button","","color","warn","matTooltip","Eliminar",3,"click"],["mat-header-row",""],["mat-row",""],[1,"mat-row"],["colspan","3",1,"mat-cell"]],template:function(r,n){if(1&r){const o=a.RV6();a.j41(0,"mat-card",1)(1,"mat-card-content",2)(2,"div",3)(3,"div",4)(4,"button",5),a.bIt("click",function(){return a.eBV(o),a.Njj(n.crearCausaRaiz())}),a.EFF(5," Nuevo Causa Ra\xedz"),a.k0s()(),a.j41(6,"div",4)(7,"mat-form-field",6)(8,"input",7,0),a.bIt("keyup",function(L){return a.eBV(o),a.Njj(n.applyFilter(L))}),a.k0s()()()(),a.j41(10,"div",8)(11,"table",9),a.qex(12,10),a.DNE(13,k,2,0,"th",11)(14,j,2,1,"td",12),a.bVm(),a.qex(15,13),a.DNE(16,S,2,0,"th",14)(17,T,7,0,"td",12),a.bVm(),a.DNE(18,I,1,0,"tr",15)(19,w,1,0,"tr",16)(20,G,3,1,"tr",17),a.k0s(),a.nrm(21,"mat-paginator",18),a.k0s()()()}2&r&&(a.R7$(11),a.Y8G("dataSource",n.dataSource),a.R7$(7),a.Y8G("matHeaderRowDef",n.displayedColumns),a.R7$(),a.Y8G("matRowDefColumns",n.displayedColumns),a.R7$(2),a.Y8G("pageSizeOptions",a.lJ4(4,y)))},dependencies:[z.MD,c.tP,c.Zl,c.tL,c.ji,c.cC,c.YV,c.iL,c.KS,c.$R,c.YZ,c.NB,c.ky,R.Ou,R.iy,b.NQ,b.B4,b.aE,O.m_,O.An,p.Hl,p.$z,p.iY,m.Hu,m.RN,m.m2,F.hM,g._T,u.RG,u.rl,f.fS,f.fg,v.uc,v.oV,_.D6],styles:[".page-container[_ngcontent-%COMP%]{padding:20px;max-width:1200px;margin:0 auto}.page-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:20px}.page-header[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{margin:0;font-size:24px;font-weight:500}.filter-container[_ngcontent-%COMP%]{margin-bottom:20px}.filter-container[_ngcontent-%COMP%]   mat-form-field[_ngcontent-%COMP%]{width:100%}.table-container[_ngcontent-%COMP%]{position:relative;min-height:200px;overflow:auto}.table-container[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]{width:100%}.table-container[_ngcontent-%COMP%]   th.mat-header-cell[_ngcontent-%COMP%]{font-weight:700;color:#000000de}.table-container[_ngcontent-%COMP%]   .mat-column-id[_ngcontent-%COMP%]{width:80px}.table-container[_ngcontent-%COMP%]   .mat-column-acciones[_ngcontent-%COMP%]{width:120px;text-align:center}.loading-shade[_ngcontent-%COMP%]{position:absolute;inset:0;background:#00000026;z-index:1;display:flex;align-items:center;justify-content:center}.mat-row[_ngcontent-%COMP%]:hover{background-color:#f5f5f5}@media (max-width: 768px){.page-header[_ngcontent-%COMP%]{flex-direction:column;align-items:flex-start}.page-header[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{margin-top:10px}.mat-column-id[_ngcontent-%COMP%]{display:none}.table-container[_ngcontent-%COMP%]{overflow-x:auto}}"]})}return e})();var s=i(9417),D=i(8032),E=i.n(D);function B(e,l){1&e&&(a.j41(0,"mat-error"),a.EFF(1," El nombre es obligatorio "),a.k0s())}function U(e,l){1&e&&(a.j41(0,"mat-error"),a.EFF(1," El nombre no debe exceder los 255 caracteres "),a.k0s())}function N(e,l){1&e&&(a.j41(0,"span"),a.EFF(1,"Guardar"),a.k0s())}function X(e,l){1&e&&(a.j41(0,"mat-error"),a.EFF(1," El nombre es obligatorio "),a.k0s())}function V(e,l){1&e&&(a.j41(0,"mat-error"),a.EFF(1," El nombre no debe exceder los 255 caracteres "),a.k0s())}function H(e,l){1&e&&(a.j41(0,"span"),a.EFF(1,"Guardar cambios"),a.k0s())}const A=[{path:"",data:{roles:["admin","gestor","secretaria","supervisor","tecnico"],title:"Mantenedor de Causas Ra\xedz"},children:[{path:"",component:$},{path:"crear",component:(()=>{class e{constructor(t,r,n,o){this.fb=t,this.http=r,this.router=n,this.snackBar=o,this.loading=!1}ngOnInit(){this.inicializarFormulario()}inicializarFormulario(){this.causaRaizForm=this.fb.group({nombre:["",[s.k0.required,s.k0.maxLength(255)]]})}onSubmit(){this.causaRaizForm.invalid||E().fire({title:"\xbfEst\xe1s seguro?",text:"\xbfDeseas crear esta nueva causa ra\xedz?",icon:"question",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"S\xed, crear",cancelButtonText:"Cancelar"}).then(t=>{t.isConfirmed&&(this.loading=!0,this.http.post(`${C.c.apiUrl}causas-raiz`,this.causaRaizForm.value).subscribe({next:()=>{E().fire("\xa1Creado!","La causa ra\xedz ha sido creada correctamente.","success"),this.router.navigate(["/mantenedores/causa-raiz"])},error:r=>{console.error("Error al crear causa ra\xedz:",r);let n="Error al crear causa ra\xedz";r.error&&r.error.message?n=r.error.message:409===r.status&&(n="Ya existe una causa ra\xedz con este nombre"),E().fire("Error",n,"error"),this.loading=!1},complete:()=>{this.loading=!1}}))})}cancelar(){this.router.navigate(["/mantenedores/causa-raiz"])}static#a=this.\u0275fac=function(r){return new(r||e)(a.rXU(s.ok),a.rXU(x.Qq),a.rXU(h.Ix),a.rXU(g.UG))};static#t=this.\u0275cmp=a.VBU({type:e,selectors:[["app-crear-causa-raiz"]],standalone:!0,features:[a.aNF],decls:15,vars:5,consts:[[1,"cardWithShadow"],[1,"p-24"],[1,"form-container"],[3,"ngSubmit","formGroup"],["appearance","outline",1,"full-width"],["matInput","","formControlName","nombre","placeholder","Ingrese el nombre de la causa ra\xedz","required",""],[4,"ngIf"],["align","end"],["mat-button","","type","button",3,"click"],["mat-raised-button","","color","primary","type","submit",3,"disabled"]],template:function(r,n){if(1&r&&(a.j41(0,"mat-card",0)(1,"mat-card-content",1)(2,"div",2)(3,"form",3),a.bIt("ngSubmit",function(){return n.onSubmit()}),a.j41(4,"mat-form-field",4)(5,"mat-label"),a.EFF(6,"Nombre"),a.k0s(),a.nrm(7,"input",5),a.DNE(8,B,2,0,"mat-error",6)(9,U,2,0,"mat-error",6),a.k0s(),a.j41(10,"mat-card-actions",7)(11,"button",8),a.bIt("click",function(){return n.cancelar()}),a.EFF(12,"Cancelar"),a.k0s(),a.j41(13,"button",9),a.DNE(14,N,2,0,"span",6),a.k0s()()()()()()),2&r){let o,d;a.R7$(3),a.Y8G("formGroup",n.causaRaizForm),a.R7$(5),a.Y8G("ngIf",null==(o=n.causaRaizForm.get("nombre"))?null:o.hasError("required")),a.R7$(),a.Y8G("ngIf",null==(d=n.causaRaizForm.get("nombre"))?null:d.hasError("maxlength")),a.R7$(4),a.Y8G("disabled",n.causaRaizForm.invalid||n.loading),a.R7$(),a.Y8G("ngIf",!n.loading)}},dependencies:[z.MD,z.bT,m.Hu,m.RN,m.YY,m.m2,u.RG,u.rl,u.nJ,u.TL,_.D6,f.fS,f.fg,p.Hl,p.$z,g._T,h.iI,s.X1,s.qT,s.me,s.BC,s.cb,s.YS,s.j4,s.JD],styles:[".page-container[_ngcontent-%COMP%]{padding:20px;max-width:800px;margin:0 auto}.page-header[_ngcontent-%COMP%]{margin-bottom:20px}.page-header[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{margin:0;font-size:24px;font-weight:500}.form-container[_ngcontent-%COMP%]   mat-card[_ngcontent-%COMP%]{padding:20px}.form-container[_ngcontent-%COMP%]   mat-card-content[_ngcontent-%COMP%]{padding:16px}.full-width[_ngcontent-%COMP%]{width:100%}mat-card-actions[_ngcontent-%COMP%]{padding:16px;display:flex;justify-content:flex-end;gap:8px}button[type=submit][_ngcontent-%COMP%]{min-width:120px;display:flex;align-items:center;justify-content:center}button[type=submit][_ngcontent-%COMP%]   mat-spinner[_ngcontent-%COMP%]{margin-right:8px}"]})}return e})(),data:{roles:["admin","gestor"],title:"Crear Causa Ra\xedz"}},{path:"editar/:id",component:(()=>{class e{constructor(t,r,n,o,d){this.fb=t,this.http=r,this.router=n,this.route=o,this.snackBar=d,this.loading=!1}ngOnInit(){this.inicializarFormulario(),this.cargarCausaRaiz()}inicializarFormulario(){this.causaRaizForm=this.fb.group({nombre:["",[s.k0.required,s.k0.maxLength(255)]]})}cargarCausaRaiz(){this.causaRaizId=+this.route.snapshot.paramMap.get("id"),this.loading=!0,this.http.get(`${C.c.apiUrl}causas-raiz/${this.causaRaizId}`).subscribe({next:t=>{this.causaRaiz=t,this.causaRaizForm.patchValue({nombre:t.nombre}),this.loading=!1},error:t=>{console.error("Error al cargar causa ra\xedz:",t),this.snackBar.open("Error al cargar causa ra\xedz","Cerrar",{duration:3e3}),this.router.navigate(["/mantenedores/causa-raiz"]),this.loading=!1}})}onSubmit(){this.causaRaizForm.invalid||(this.loading=!0,this.http.patch(`${C.c.apiUrl}causas-raiz/${this.causaRaizId}`,this.causaRaizForm.value).subscribe({next:()=>{this.snackBar.open("Causa ra\xedz actualizada correctamente","Cerrar",{duration:3e3}),this.router.navigate(["/mantenedores/causa-raiz"])},error:t=>{console.error("Error al actualizar causa ra\xedz:",t);let r="Error al actualizar causa ra\xedz";t.error&&t.error.message?r=t.error.message:409===t.status&&(r="Ya existe otra causa ra\xedz con este nombre"),this.snackBar.open(r,"Cerrar",{duration:5e3}),this.loading=!1},complete:()=>{this.loading=!1}}))}cancelar(){this.router.navigate(["/mantenedores/causa-raiz"])}static#a=this.\u0275fac=function(r){return new(r||e)(a.rXU(s.ok),a.rXU(x.Qq),a.rXU(h.Ix),a.rXU(h.nX),a.rXU(g.UG))};static#t=this.\u0275cmp=a.VBU({type:e,selectors:[["app-editar-causa-raiz"]],standalone:!0,features:[a.aNF],decls:14,vars:5,consts:[[1,"cardWithShadow"],[1,"p-24"],[3,"ngSubmit","formGroup"],["appearance","outline",1,"full-width"],["matInput","","formControlName","nombre","placeholder","Ingrese el nombre de la causa ra\xedz","required",""],[4,"ngIf"],["align","end"],["mat-button","","type","button",3,"click"],["mat-raised-button","","color","primary","type","submit",3,"disabled"]],template:function(r,n){if(1&r&&(a.j41(0,"mat-card",0)(1,"mat-card-content",1)(2,"form",2),a.bIt("ngSubmit",function(){return n.onSubmit()}),a.j41(3,"mat-form-field",3)(4,"mat-label"),a.EFF(5,"Nombre"),a.k0s(),a.nrm(6,"input",4),a.DNE(7,X,2,0,"mat-error",5)(8,V,2,0,"mat-error",5),a.k0s(),a.j41(9,"mat-card-actions",6)(10,"button",7),a.bIt("click",function(){return n.cancelar()}),a.EFF(11,"Cancelar"),a.k0s(),a.j41(12,"button",8),a.DNE(13,H,2,0,"span",5),a.k0s()()()()()),2&r){let o,d;a.R7$(2),a.Y8G("formGroup",n.causaRaizForm),a.R7$(5),a.Y8G("ngIf",null==(o=n.causaRaizForm.get("nombre"))?null:o.hasError("required")),a.R7$(),a.Y8G("ngIf",null==(d=n.causaRaizForm.get("nombre"))?null:d.hasError("maxlength")),a.R7$(4),a.Y8G("disabled",n.causaRaizForm.invalid||n.loading),a.R7$(),a.Y8G("ngIf",!n.loading)}},dependencies:[z.MD,z.bT,m.Hu,m.RN,m.YY,m.m2,u.RG,u.rl,u.nJ,u.TL,f.fS,f.fg,_.D6,p.Hl,p.$z,g._T,h.iI,s.X1,s.qT,s.me,s.BC,s.cb,s.YS,s.j4,s.JD],styles:[".page-container[_ngcontent-%COMP%]{padding:20px;max-width:800px;margin:0 auto}.page-header[_ngcontent-%COMP%]{margin-bottom:20px}.page-header[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{margin:0;font-size:24px;font-weight:500}.loading-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center;margin:50px 0}.loading-container[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin-top:20px;font-size:16px;color:#0009}.form-container[_ngcontent-%COMP%]   mat-card[_ngcontent-%COMP%]{padding:20px}.form-container[_ngcontent-%COMP%]   mat-card-content[_ngcontent-%COMP%]{padding:16px}.full-width[_ngcontent-%COMP%]{width:100%}mat-card-actions[_ngcontent-%COMP%]{padding:16px;display:flex;justify-content:flex-end;gap:8px}button[type=submit][_ngcontent-%COMP%]{min-width:140px;display:flex;align-items:center;justify-content:center}button[type=submit][_ngcontent-%COMP%]   mat-spinner[_ngcontent-%COMP%]{margin-right:8px}"]})}return e})(),data:{roles:["admin","gestor"],title:"Editar Causa Ra\xedz"}}]}]}}]);