<mat-card class="cardWithShadow">
    <mat-card-content class="p-24">
        <div class="container">
  <h2>Modificar Solicitud</h2>
  
  <form [formGroup]="solicitudForm">
    <!-- Información del Cliente y Local -->
    <div class="section-title">Información General</div>
    <div class="form-row">
      <mat-form-field appearance="fill">
        <mat-label>Cliente</mat-label>
        <input matInput formControlName="client.nombre">
      </mat-form-field>

      <mat-form-field appearance="fill">
        <mat-label>Local</mat-label>
        <input matInput formControlName="local.nombre_local">
      </mat-form-field>
    </div>

    <div class="form-row">
      <mat-form-field appearance="fill">
        <mat-label>Dirección Local</mat-label>
        <input matInput formControlName="local.direccion">
      </mat-form-field>

      <mat-form-field appearance="fill">
        <mat-label>Técnico Asignado</mat-label>
        <input matInput formControlName="tecnico_asignado.name">
      </mat-form-field>
    </div>

    <!-- Detalles de la Solicitud -->
    <div class="section-title">Detalles de la Solicitud</div>
    <div class="form-row">
      <mat-form-field appearance="fill">
        <mat-label>Tipo de Servicio</mat-label>
        <input matInput formControlName="tipoServicioId">
      </mat-form-field>

      <mat-form-field appearance="fill">
        <mat-label>Sector de Trabajo</mat-label>
        <input matInput formControlName="sectorTrabajoId">
      </mat-form-field>
    </div>

    <div class="form-row">
      <mat-form-field appearance="fill">
        <mat-label>Especialidad</mat-label>
        <mat-select formControlName="especialidad">
          <mat-option *ngFor="let especialidad of especialidades" [value]="especialidad">
            {{especialidad}}
          </mat-option>
        </mat-select>
      </mat-form-field>

      <mat-form-field appearance="fill">
        <mat-label>Fecha de Ingreso</mat-label>
        <input matInput [matDatepicker]="picker" formControlName="fechaIngreso">
        <mat-datepicker-toggle matSuffix [for]="picker"></mat-datepicker-toggle>
        <mat-datepicker #picker></mat-datepicker>
      </mat-form-field>
    </div>

    <div class="form-row">
      <mat-form-field appearance="fill">
        <mat-label>Ticket Gruman</mat-label>
        <input matInput formControlName="ticketGruman">
      </mat-form-field>

      <mat-form-field appearance="fill">
        <mat-label>Status</mat-label>
        <input matInput formControlName="status">
      </mat-form-field>
    </div>

    <mat-form-field appearance="fill" class="full-width">
      <mat-label>Observaciones</mat-label>
      <textarea matInput formControlName="observaciones" rows="4"></textarea>
    </mat-form-field>

    <!-- Fechas de Servicio -->
    <div class="section-title">Fechas de Servicio</div>
    <div class="form-row">
      <mat-form-field appearance="fill">
        <mat-label>Fecha/Hora Inicio Servicio</mat-label>
        <input matInput formControlName="fecha_hora_inicio_servicio">
      </mat-form-field>

      <mat-form-field appearance="fill">
        <mat-label>Fecha/Hora Fin Servicio</mat-label>
        <input matInput formControlName="fecha_hora_fin_servicio">
      </mat-form-field>
    </div>

    <!-- Ubicación -->
    <div class="section-title">Ubicación</div>
    <div class="form-row">
      <mat-form-field appearance="fill">
        <mat-label>Longitud</mat-label>
        <input matInput formControlName="longitud_movil" type="number" step="0.000001">
      </mat-form-field>

      <mat-form-field appearance="fill">
        <mat-label>Latitud</mat-label>
        <input matInput formControlName="latitud_movil" type="number" step="0.000001">
      </mat-form-field>
    </div>

    <!-- Firma del Cliente -->
    <div class="section-title">Firma del Cliente</div>
    <div class="signature-container" *ngIf="solicitud?.firma_cliente">
      <img [src]="solicitud.firma_cliente" alt="Firma del cliente" class="signature-image">
    </div>

    <!-- Item Repuestos -->
    <div class="section-title">Repuestos Utilizados</div>
    <div class="table-container mat-elevation-z2">
      <table mat-table [dataSource]="itemRepuestos" class="full-width">
        <!-- ID Column -->
        <ng-container matColumnDef="id">
          <th mat-header-cell *matHeaderCellDef>ID</th>
          <td mat-cell *matCellDef="let element">{{element.id}}</td>
        </ng-container>

        <!-- Item ID Column -->
        <ng-container matColumnDef="itemId">
          <th mat-header-cell *matHeaderCellDef>Item ID</th>
          <td mat-cell *matCellDef="let element">{{element.itemId}}</td>
        </ng-container>

        <!-- Comentario Column -->
        <ng-container matColumnDef="comentario">
          <th mat-header-cell *matHeaderCellDef>Comentario</th>
          <td mat-cell *matCellDef="let element">{{element.comentario}}</td>
        </ng-container>

        <!-- Cantidad Column -->
        <ng-container matColumnDef="cantidad">
          <th mat-header-cell *matHeaderCellDef>Cantidad</th>
          <td mat-cell *matCellDef="let element">{{element.cantidad}}</td>
        </ng-container>

        <!-- Fecha Agregado Column -->
        <ng-container matColumnDef="fechaAgregado">
          <th mat-header-cell *matHeaderCellDef>Fecha Agregado</th>
          <td mat-cell *matCellDef="let element">{{element.fechaAgregado | date:'medium'}}</td>
        </ng-container>

        <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
        <tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>
      </table>
    </div>

    <div class="actions">
      <button mat-button (click)="onCancel()">Cancelar</button>
     <!--  <button mat-raised-button color="primary" (click)="onSubmit()">Guardar</button> -->
      <button mat-raised-button style="background-color: #4CAF50; color: white;" (click)="onValidate()">Validar Solicitud</button>
    </div>
  </form>
</div>

</mat-card-content>
</mat-card>

<style>
.signature-container {
  margin: 20px 0;
  padding: 10px;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.signature-image {
  max-width: 100%;
  height: auto;
}

.table-container {
  margin: 20px 0;
  overflow-x: auto;
}

table {
  width: 100%;
}

th.mat-header-cell,
td.mat-cell {
  padding: 12px;
}

.mat-row:nth-child(even) {
  background-color: #f5f5f5;
}

.mat-header-row {
  background-color: #f0f0f0;
}
</style>

 